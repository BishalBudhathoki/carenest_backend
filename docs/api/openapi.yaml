openapi: 3.0.3

info:
  title: Invoice Management & NDIS Support API
  version: 2.0.0
  description: |
    Comprehensive REST API for managing invoices, organizations, clients, employees, and NDIS support operations.
    
    ## Key Features
    
    - Multi-organization support with role-based access control
    - Complete NDIS pricing and invoicing system
    - Time tracking and payroll management
    - Compliance and training tracking
    - Real-time analytics and reporting
    - Client portal and appointment scheduling
    - Expense management and trip tracking
    
  contact:
    name: API Support Team
    email: api-support@yourdomain.com
  
  license:
    name: Proprietary

servers:
  - url: http://localhost:3000
    description: Local Development
  - url: https://api-staging.yourdomain.com
    description: Staging
  - url: https://api.yourdomain.com
    description: Production

tags:
  - name: Authentication
    description: User authentication, registration, and session management
  - name: Authentication V2
    description: Enhanced authentication with improved security
  - name: Users
    description: User management and employee operations
  - name: Organizations
    description: Multi-organization management and branding
  - name: Invoicing
    description: Invoice generation, management, and sharing
  - name: Pricing
    description: NDIS pricing configuration and validation
  - name: Price Validation
    description: Price compliance and validation
  - name: Price Prompts
    description: Interactive pricing prompts for invoice generation
  - name: Clients
    description: Client management and assignments
  - name: Businesses
    description: Business entity management
  - name: Client Portal
    description: Client-facing portal for invoices and appointments
  - name: Scheduling
    description: Shift scheduling and roster management
  - name: Assignments
    description: Client-to-employee assignments
  - name: Appointments
    description: Appointment tracking and management
  - name: Time Tracking
    description: Active timers and worked time logging
  - name: Timesheets
    description: Timesheet management and export
  - name: Expenses
    description: Expense tracking and approval
  - name: Recurring Expenses
    description: Automated recurring expense processing
  - name: Trips
    description: Trip and mileage tracking
  - name: OCR
    description: Receipt parsing and OCR
  - name: Leave
    description: Leave management and balances
  - name: Requests
    description: General request management
  - name: Payroll
    description: Payroll processing and export
  - name: Earnings
    description: Employee earnings and pay rates
  - name: Bank Details
    description: Bank account management
  - name: Holidays
    description: Public holiday management
  - name: Calendar
    description: Calendar synchronization
  - name: Teams
    description: Team management and availability
  - name: Emergency
    description: Emergency broadcasts and alerts
  - name: Geofencing
    description: Location-based tracking
  - name: Notes
    description: Client notes and care plans
  - name: Notifications
    description: Notification settings and history
  - name: Reminders
    description: Automated reminder system
  - name: Compliance
    description: Compliance tracking and reporting
  - name: Training
    description: Training modules and certifications
  - name: Payments
    description: Payment processing and credit notes
  - name: Accounting
    description: Accounting system integration
  - name: Webhooks
    description: External webhook handlers
  - name: Analytics
    description: Financial and operational analytics
  - name: API Usage
    description: API usage tracking and metrics
  - name: Security
    description: Security dashboard and monitoring
  - name: Audit
    description: Audit logs and compliance tracking
  - name: Settings
    description: System settings and configuration
  - name: Configuration
    description: Job roles, leave types, and tax brackets
  - name: Support Items
    description: NDIS support item catalog
  - name: AI & Voice
    description: AI timing and voice commands
  - name: Onboarding
    description: Employee onboarding workflow
  - name: System
    description: Health checks and metrics
  - name: Scheduler
    description: Background task scheduling

x-tagGroups:
  - name: Authentication & Security
    tags:
      - Authentication
      - Authentication V2
      - Users
      - Security
      - Audit
  - name: Organization Management
    tags:
      - Organizations
      - Businesses
      - Configuration
      - Settings
  - name: Invoicing & Billing
    tags:
      - Invoicing
      - Pricing
      - Price Validation
      - Price Prompts
      - Support Items
  - name: Client Management
    tags:
      - Clients
      - Client Portal
      - Notes
  - name: Scheduling & Time
    tags:
      - Scheduling
      - Assignments
      - Appointments
      - Time Tracking
      - Timesheets
  - name: Financial Management
    tags:
      - Expenses
      - Recurring Expenses
      - Trips
      - OCR
      - Payroll
      - Earnings
      - Bank Details
      - Payments
      - Accounting
  - name: Leave & Requests
    tags:
      - Leave
      - Requests
      - Holidays
      - Calendar
  - name: Team & Emergency
    tags:
      - Teams
      - Emergency
      - Geofencing
  - name: Notifications & Compliance
    tags:
      - Notifications
      - Reminders
      - Compliance
      - Training
  - name: Analytics & Reporting
    tags:
      - Analytics
      - API Usage
  - name: Integration & Automation
    tags:
      - Webhooks
      - AI & Voice
      - Scheduler
  - name: System Management
    tags:
      - Onboarding
      - System

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token from login endpoints

  parameters:
    organizationIdPath:
      name: organizationId
      in: path
      required: true
      schema:
        type: string
      example: "507f1f77bcf86cd799439011"
    
    organizationIdQuery:
      name: organizationId
      in: query
      required: true
      schema:
        type: string
      example: "507f1f77bcf86cd799439011"
    
    emailPath:
      name: email
      in: path
      required: true
      schema:
        type: string
        format: email
      example: "user@example.com"
    
    pageQuery:
      name: page
      in: query
      schema:
        type: integer
        minimum: 1
        default: 1
    
    limitQuery:
      name: limit
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 50

  schemas:
    Error:
      type: object
      properties:
        statusCode:
          type: integer
        message:
          type: string
        error:
          type: string
        errors:
          type: array
          items:
            type: object
    
    User:
      type: object
      properties:
        _id:
          type: string
        email:
          type: string
          format: email
        firstName:
          type: string
        lastName:
          type: string
        role:
          type: string
          enum: [admin, manager, user, employee, client]
        organizationId:
          type: string
        isActive:
          type: boolean
        photo:
          type: string
        createdAt:
          type: string
          format: date-time
    
    Organization:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
        organizationCode:
          type: string
        ownerEmail:
          type: string
        createdAt:
          type: string
          format: date-time
        memberCount:
          type: integer
    
    Client:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
        email:
          type: string
        phone:
          type: string
        address:
          type: string
        organizationId:
          type: string
        ndisNumber:
          type: string
        planManaged:
          type: boolean
    
    Invoice:
      type: object
      properties:
        _id:
          type: string
        invoiceNumber:
          type: string
        organizationId:
          type: string
        clientId:
          type: string
        totalAmount:
          type: number
        paymentStatus:
          type: string
          enum: [pending, paid, overdue]
        createdAt:
          type: string
          format: date-time
    
    Pricing:
      type: object
      properties:
        _id:
          type: string
        organizationId:
          type: string
        supportItemNumber:
          type: string
        pricingType:
          type: string
          enum: [custom_price, multiplier, ndis_standard]
        customPrice:
          type: number
        multiplier:
          type: number
        approvalStatus:
          type: string
          enum: [pending, approved, rejected]

paths:
  # ==========================================
  # AUTHENTICATION
  # ==========================================
  
  /auth/register:
    post:
      tags: [Authentication]
      summary: Register new user
      description: Register a new user account with email verification
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, name]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
                name:
                  type: string
      responses:
        '201':
          description: User registered successfully
        '400':
          description: Validation error
        '409':
          description: Email already exists

  /auth/login:
    post:
      tags: [Authentication]
      summary: User login
      description: Authenticate user and return JWT token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          description: Invalid credentials
        '403':
          description: IP blocked due to failed attempts

  /auth/secure-login:
    post:
      tags: [Authentication]
      summary: Enhanced secure login
      description: Secure login with enhanced security features
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login successful
        '401':
          description: Invalid credentials

  /auth/register-fcm-token:
    post:
      tags: [Authentication]
      summary: Register FCM push token
      description: Register Firebase Cloud Messaging token for push notifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
      responses:
        '200':
          description: Token registered

  /auth/verify-email:
    post:
      tags: [Authentication]
      summary: Verify email with OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, otp]
              properties:
                email:
                  type: string
                otp:
                  type: string
      responses:
        '200':
          description: Email verified
        '400':
          description: Invalid OTP

  /auth/forgot-password:
    post:
      tags: [Authentication]
      summary: Request password reset
      description: Send OTP for password reset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email:
                  type: string
      responses:
        '200':
          description: OTP sent
        '404':
          description: User not found

  /auth/reset-password:
    post:
      tags: [Authentication]
      summary: Reset password with OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, otp, newPassword]
              properties:
                email:
                  type: string
                otp:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Password reset successful
        '400':
          description: Invalid OTP

  /auth/profile:
    get:
      tags: [Authentication]
      summary: Get user profile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Profile retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
    put:
      tags: [Authentication]
      summary: Update user profile
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
      responses:
        '200':
          description: Profile updated

  /auth/change-password:
    post:
      tags: [Authentication]
      summary: Change password
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [oldPassword, newPassword]
              properties:
                oldPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Password changed
        '400':
          description: Invalid old password

  /auth/logout:
    post:
      tags: [Authentication]
      summary: Logout user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logged out successfully

  /auth/refresh-token:
    post:
      tags: [Authentication]
      summary: Refresh JWT token
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Token refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string

  /auth/verify-token:
    get:
      tags: [Authentication]
      summary: Verify token validity
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Token is valid
        '401':
          description: Invalid token

  /auth/account:
    delete:
      tags: [Authentication]
      summary: Deactivate account
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Account deactivated

  /auth/assign-role:
    post:
      tags: [Authentication]
      summary: Assign job role to user
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                role:
                  type: string
      responses:
        '200':
          description: Role assigned

  /auth/security-log:
    post:
      tags: [Authentication]
      summary: Log security events
      description: Ingest security event logs from mobile clients
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Log recorded

  /auth/health:
    get:
      tags: [Authentication]
      summary: Auth service health check
      responses:
        '200':
          description: Service healthy

  /auth/admin/reset-rate-limit:
    post:
      tags: [Authentication]
      summary: Reset rate limits
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: Rate limit reset

  # ==========================================
  # AUTHENTICATION V2
  # ==========================================

  /auth/v2/register:
    post:
      tags: [Authentication V2]
      summary: Register user (v2)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        '201':
          description: User registered

  /auth/v2/login:
    post:
      tags: [Authentication V2]
      summary: Login (v2)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login successful

  /auth/v2/refresh-token:
    post:
      tags: [Authentication V2]
      summary: Refresh token (v2)
      responses:
        '200':
          description: Token refreshed

  /auth/v2/logout:
    post:
      tags: [Authentication V2]
      summary: Logout (v2)
      responses:
        '200':
          description: Logged out

  /auth/v2/me:
    get:
      tags: [Authentication V2]
      summary: Get current user (v2)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

  /auth/v2/change-password:
    post:
      tags: [Authentication V2]
      summary: Change password (v2)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Password changed

  # ==========================================
  # USERS
  # ==========================================

  /user/getUsers:
    get:
      tags: [Users]
      summary: Get all users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Users retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'

  /user/organization/{organizationId}/employees:
    get:
      tags: [Users]
      summary: Get organization employees
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Employees retrieved

  /user/fixClientOrganizationId:
    post:
      tags: [Users]
      summary: Fix client organization ID
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Fixed

  /user/photo/{email}:
    get:
      tags: [Users]
      summary: Get user photo
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/emailPath'
      responses:
        '200':
          description: Photo URL
    post:
      tags: [Users]
      summary: Upload user photo
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                photo:
                  type: string
                  format: binary
      responses:
        '200':
          description: Photo uploaded

  /user/init-data/{email}:
    get:
      tags: [Users]
      summary: Get initialization data
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/emailPath'
      responses:
        '200':
          description: Init data

  # ==========================================
  # ORGANIZATIONS
  # ==========================================

  /organization/create:
    post:
      tags: [Organizations]
      summary: Create organization
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  minLength: 2
                  maxLength: 100
      responses:
        '201':
          description: Organization created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'

  /organization/user/my-organizations:
    get:
      tags: [Organizations]
      summary: Get my organizations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Organizations retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Organization'

  /organization/verify-code:
    post:
      tags: [Organizations]
      summary: Verify organization code
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code:
                  type: string
      responses:
        '200':
          description: Code verified

  /organization/switch/{organizationId}:
    post:
      tags: [Organizations]
      summary: Switch active organization
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Organization switched

  /organization/{organizationId}:
    get:
      tags: [Organizations]
      summary: Get organization details
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Organization details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
    put:
      tags: [Organizations]
      summary: Update organization
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
      responses:
        '200':
          description: Organization updated

  /organization/{organizationId}/members:
    get:
      tags: [Organizations]
      summary: Get organization members
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Members retrieved

  /organization/{organizationId}/businesses:
    get:
      tags: [Organizations]
      summary: Get organization businesses
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Businesses retrieved

  /organization/{organizationId}/clients:
    get:
      tags: [Organizations]
      summary: Get organization clients
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Clients retrieved

  /organization/{organizationId}/employees:
    get:
      tags: [Organizations]
      summary: Get organization employees
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Employees retrieved

  /organization/{organizationId}/branding:
    get:
      tags: [Organizations]
      summary: Get organization branding
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Branding retrieved
    put:
      tags: [Organizations]
      summary: Update organization branding
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                logo:
                  type: string
                primaryColor:
                  type: string
      responses:
        '200':
          description: Branding updated

  /multiorg/rollup:
    get:
      tags: [Organizations]
      summary: Get multi-org rollup stats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Rollup statistics

  # ==========================================
  # INVOICING
  # ==========================================

  /api/invoices:
    post:
      tags: [Invoicing]
      summary: Create invoice
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [clientId, organizationId]
              properties:
                clientId:
                  type: string
                organizationId:
                  type: string
                lineItems:
                  type: array
                  items:
                    type: object
      responses:
        '201':
          description: Invoice created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invoice'
    get:
      tags: [Invoicing]
      summary: Get invoice list
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
        - $ref: '#/components/parameters/pageQuery'
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Invoice list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Invoice'

  /api/invoices/{invoiceId}:
    get:
      tags: [Invoicing]
      summary: Get invoice details
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invoice details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invoice'
    delete:
      tags: [Invoicing]
      summary: Delete invoice
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invoice deleted

  /api/invoices/{invoiceId}/payment-status:
    patch:
      tags: [Invoicing]
      summary: Update payment status
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [paymentStatus]
              properties:
                paymentStatus:
                  type: string
                  enum: [pending, paid, overdue]
      responses:
        '200':
          description: Status updated

  /api/invoices/{invoiceId}/share:
    post:
      tags: [Invoicing]
      summary: Share invoice
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recipients:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Invoice shared

  /api/invoices/{invoiceId}/share/pdf:
    post:
      tags: [Invoicing]
      summary: Share invoice as PDF
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: PDF shared

  /api/invoices/stats/{organizationId}:
    get:
      tags: [Invoicing]
      summary: Get invoice statistics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Invoice statistics

  /invoice/generate-line-items:
    post:
      tags: [Invoicing]
      summary: Generate invoice line items
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Line items generated

  /invoice/preview/{userEmail}/{clientEmail}:
    get:
      tags: [Invoicing]
      summary: Preview invoice
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
        - name: clientEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invoice preview

  /invoice/available-assignments/{userEmail}:
    get:
      tags: [Invoicing]
      summary: Get available assignments for invoicing
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Available assignments

  /invoice/validate-generation-data:
    post:
      tags: [Invoicing]
      summary: Validate invoice generation data
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Validation result

  /invoice/bulk-generate:
    post:
      tags: [Invoicing]
      summary: Generate bulk invoices
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invoices generated

  /invoice/validate-line-items:
    post:
      tags: [Invoicing]
      summary: Validate invoice line items
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Line items validated

  /invoice/validate-pricing-realtime:
    post:
      tags: [Invoicing]
      summary: Validate pricing real-time
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Pricing validated

  /invoice/validation-report:
    post:
      tags: [Invoicing]
      summary: Get invoice validation report
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Validation report

  # ==========================================
  # PRICING
  # ==========================================

  /pricing/create:
    post:
      tags: [Pricing]
      summary: Create custom pricing
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [organizationId, supportItemNumber, pricingType]
              properties:
                organizationId:
                  type: string
                supportItemNumber:
                  type: string
                pricingType:
                  type: string
                  enum: [custom_price, multiplier, ndis_standard]
                customPrice:
                  type: number
                multiplier:
                  type: number
      responses:
        '201':
          description: Pricing created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Pricing'

  /pricing/organization/{organizationId}:
    get:
      tags: [Pricing]
      summary: Get organization pricing
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Pricing list

  /pricing/{id}:
    get:
      tags: [Pricing]
      summary: Get pricing by ID
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pricing details
    put:
      tags: [Pricing]
      summary: Update pricing
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Pricing updated
    delete:
      tags: [Pricing]
      summary: Delete pricing
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pricing deleted

  /pricing/{id}/approval:
    put:
      tags: [Pricing]
      summary: Update pricing approval status
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                approvalStatus:
                  type: string
                  enum: [approved, rejected]
      responses:
        '200':
          description: Approval updated

  /pricing/lookup/{organizationId}/{supportItemNumber}:
    get:
      tags: [Pricing]
      summary: Pricing lookup with path params
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
        - name: supportItemNumber
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pricing found

  /pricing/lookup:
    get:
      tags: [Pricing]
      summary: Pricing lookup with query params
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
        - name: supportItemNumber
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pricing found

  /pricing/bulk-lookup:
    post:
      tags: [Pricing]
      summary: Bulk pricing lookup
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Bulk pricing results

  /pricing/bulk-import:
    post:
      tags: [Pricing]
      summary: Bulk import pricing
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Pricing imported

  /pricing/fallback-base-rate/{organizationId}:
    get:
      tags: [Pricing]
      summary: Get fallback base rate
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Base rate
    put:
      tags: [Pricing]
      summary: Set fallback base rate
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                rate:
                  type: number
      responses:
        '200':
          description: Rate updated

  /pricing/standard-price/{ndisItemNumber}:
    get:
      tags: [Pricing]
      summary: Get standard NDIS price
      security:
        - bearerAuth: []
      parameters:
        - name: ndisItemNumber
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Standard price

  # ==========================================
  # PRICE VALIDATION
  # ==========================================

  /api/price-validation/validate:
    post:
      tags: [Price Validation]
      summary: Validate single price
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Validation result

  /api/price-validation/validate-batch:
    post:
      tags: [Price Validation]
      summary: Validate multiple prices
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Batch validation results

  /api/price-validation/caps/{supportItemNumber}:
    get:
      tags: [Price Validation]
      summary: Get price caps
      security:
        - bearerAuth: []
      parameters:
        - name: supportItemNumber
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Price caps

  /api/price-validation/quote-required/{supportItemNumber}:
    get:
      tags: [Price Validation]
      summary: Check if quote required
      security:
        - bearerAuth: []
      parameters:
        - name: supportItemNumber
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Quote requirement

  /api/price-validation/validate-invoice:
    post:
      tags: [Price Validation]
      summary: Validate entire invoice
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invoice validation

  /api/price-validation/stats:
    get:
      tags: [Price Validation]
      summary: Get validation statistics
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Validation stats

  # ==========================================
  # PRICE PROMPTS
  # ==========================================

  /invoice/price-prompt/create:
    post:
      tags: [Price Prompts]
      summary: Create price prompt
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Prompt created

  /invoice/price-prompt/resolve:
    post:
      tags: [Price Prompts]
      summary: Resolve price prompt
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Prompt resolved

  /invoice/price-prompt/pending/{sessionId}:
    get:
      tags: [Price Prompts]
      summary: Get pending price prompts
      security:
        - bearerAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pending prompts

  /invoice/price-prompt/cancel:
    post:
      tags: [Price Prompts]
      summary: Cancel price prompt
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Prompt cancelled

  /invoice/generate-with-prompts:
    post:
      tags: [Price Prompts]
      summary: Generate invoice with prompts
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invoice generated

  /invoice/complete-generation:
    post:
      tags: [Price Prompts]
      summary: Complete invoice generation
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Generation completed

  /api/price-prompts/create:
    post:
      tags: [Price Prompts]
      summary: Create price prompt (API)
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Prompt created

  /api/price-prompts/{promptId}/resolve:
    post:
      tags: [Price Prompts]
      summary: Resolve prompt (API)
      security:
        - bearerAuth: []
      parameters:
        - name: promptId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Prompt resolved

  /api/price-prompts/pending/{organizationId}:
    get:
      tags: [Price Prompts]
      summary: Get pending prompts (API)
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Pending prompts

  /api/price-prompts/{promptId}:
    delete:
      tags: [Price Prompts]
      summary: Cancel price prompt (API)
      security:
        - bearerAuth: []
      parameters:
        - name: promptId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Prompt cancelled

  /api/price-prompts/generate-invoice:
    post:
      tags: [Price Prompts]
      summary: Generate invoice with prompts (API)
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invoice generated

  /api/price-prompts/complete-invoice/{invoiceId}:
    post:
      tags: [Price Prompts]
      summary: Complete invoice (API)
      security:
        - bearerAuth: []
      parameters:
        - name: invoiceId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invoice completed

  # ==========================================
  # CLIENTS
  # ==========================================

  /activate:
    post:
      tags: [Clients]
      summary: Activate client
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Client activated

  /addClient:
    post:
      tags: [Clients]
      summary: Add client
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, organizationId]
              properties:
                name:
                  type: string
                email:
                  type: string
                organizationId:
                  type: string
      responses:
        '201':
          description: Client added

  /clients/{organizationId}:
    get:
      tags: [Clients]
      summary: Get clients by organization
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Clients list

  /getClients:
    get:
      tags: [Clients]
      summary: Get clients
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Clients retrieved

  /details/{clientId}:
    get:
      tags: [Clients]
      summary: Get client details
      security:
        - bearerAuth: []
      parameters:
        - name: clientId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Client details

  /updateCareNotes/{clientId}:
    post:
      tags: [Clients]
      summary: Update client care notes
      security:
        - bearerAuth: []
      parameters:
        - name: clientId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                careNotes:
                  type: string
      responses:
        '200':
          description: Notes updated

  /getMultipleClients/{emails}:
    get:
      tags: [Clients]
      summary: Get multiple clients by emails
      security:
        - bearerAuth: []
      parameters:
        - name: emails
          in: path
          required: true
          schema:
            type: string
          description: Comma-separated emails
      responses:
        '200':
          description: Clients retrieved

  /assignClientToUser:
    post:
      tags: [Clients]
      summary: Assign client to user
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Client assigned

  /getUserAssignments/{userEmail}:
    get:
      tags: [Clients]
      summary: Get user assignments
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Assignments retrieved

  # ==========================================
  # BUSINESSES
  # ==========================================

  /addBusiness:
    post:
      tags: [Businesses]
      summary: Add business
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, organizationId]
              properties:
                name:
                  type: string
                organizationId:
                  type: string
      responses:
        '201':
          description: Business added

  /businesses/{organizationId}:
    get:
      tags: [Businesses]
      summary: Get businesses by organization
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Businesses list

  # ==========================================
  # CLIENT PORTAL
  # ==========================================

  /client-portal/auth/activate:
    post:
      tags: [Client Portal]
      summary: Activate client portal account
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Account activated

  /client-portal/auth/login:
    post:
      tags: [Client Portal]
      summary: Client portal login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login successful

  /client-portal/invoices:
    get:
      tags: [Client Portal]
      summary: Get client invoices
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Invoices retrieved

  /client-portal/invoices/{id}:
    get:
      tags: [Client Portal]
      summary: Get invoice detail
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invoice detail

  /client-portal/invoices/{id}/approve:
    post:
      tags: [Client Portal]
      summary: Approve invoice
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Invoice approved

  /client-portal/invoices/{id}/dispute:
    post:
      tags: [Client Portal]
      summary: Dispute invoice
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Dispute submitted

  /client-portal/appointments:
    get:
      tags: [Client Portal]
      summary: Get client appointments
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Appointments retrieved

  /client-portal/appointments/{assignmentId}/{scheduleId}:
    get:
      tags: [Client Portal]
      summary: Get appointment detail
      security:
        - bearerAuth: []
      parameters:
        - name: assignmentId
          in: path
          required: true
          schema:
            type: string
        - name: scheduleId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Appointment detail

  /client-portal/appointments/request:
    post:
      tags: [Client Portal]
      summary: Request appointment
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Request submitted

  /client-portal/auth/change-password:
    post:
      tags: [Client Portal]
      summary: Change client password
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Password changed

  # ==========================================
  # SCHEDULING
  # ==========================================

  /schedule/shift:
    post:
      tags: [Scheduling]
      summary: Create shift
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Shift created

  /schedule/bulk:
    post:
      tags: [Scheduling]
      summary: Bulk deploy shifts
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Shifts deployed

  /schedule/shifts/{organizationId}:
    get:
      tags: [Scheduling]
      summary: Get shifts
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Shifts retrieved

  /schedule/shift/{id}:
    put:
      tags: [Scheduling]
      summary: Update shift
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Shift updated
    delete:
      tags: [Scheduling]
      summary: Delete shift
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Shift deleted

  /schedule/recommendations:
    get:
      tags: [Scheduling]
      summary: Get AI scheduling recommendations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Recommendations

  /schedule/check-conflicts:
    post:
      tags: [Scheduling]
      summary: Check scheduling conflicts
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Conflict check results

  /schedule/deploy-template:
    post:
      tags: [Scheduling]
      summary: Deploy roster template
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Template deployed

  # ==========================================
  # ASSIGNMENTS
  # ==========================================

  /assignments:
    post:
      tags: [Assignments]
      summary: Create or update assignment
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Assignment saved
    get:
      tags: [Assignments]
      summary: Get organization assignments
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Assignments retrieved

  /assignments/{id}:
    delete:
      tags: [Assignments]
      summary: Delete assignment
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Assignment deleted

  # ==========================================
  # APPOINTMENTS
  # ==========================================

  /loadAppointments/{email}:
    get:
      tags: [Appointments]
      summary: Load user appointments
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/emailPath'
      responses:
        '200':
          description: Appointments loaded

  /loadAppointmentDetails/{userEmail}/{clientEmail}:
    get:
      tags: [Appointments]
      summary: Get appointment details
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
        - name: clientEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Appointment details

  /getOrganizationAssignments/{organizationId}:
    get:
      tags: [Appointments]
      summary: Get organization assignments
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Assignments

  /removeClientAssignment:
    delete:
      tags: [Appointments]
      summary: Remove client assignment
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Assignment removed

  /setWorkedTime:
    post:
      tags: [Appointments]
      summary: Set worked time
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Worked time set

  # ==========================================
  # TIME TRACKING
  # ==========================================

  /active-timers/start:
    post:
      tags: [Time Tracking]
      summary: Start timer
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Timer started

  /active-timers/stop:
    post:
      tags: [Time Tracking]
      summary: Stop timer
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Timer stopped

  /active-timers/{organizationId}:
    get:
      tags: [Time Tracking]
      summary: Get active timers
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Active timers

  /worked-time/history/{clientId}:
    get:
      tags: [Time Tracking]
      summary: Get visit history for client
      security:
        - bearerAuth: []
      parameters:
        - name: clientId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Visit history

  /worked-time/recent/{userEmail}:
    get:
      tags: [Time Tracking]
      summary: Get recent visits for user
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Recent visits

  /worked-time/getWorkedTime/{userEmail}/{clientEmail}:
    get:
      tags: [Time Tracking]
      summary: Get worked time
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
        - name: clientEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Worked time

  # ==========================================
  # TIMESHEETS
  # ==========================================

  /timesheets/list:
    post:
      tags: [Timesheets]
      summary: Get timesheet list
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Timesheets

  /timesheets/export-payroll:
    post:
      tags: [Timesheets]
      summary: Export payroll data
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Payroll exported

  /reminders/timesheet/status:
    get:
      tags: [Reminders]
      summary: Get timesheet reminder status
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Status

  /reminders/timesheet/trigger:
    post:
      tags: [Reminders]
      summary: Trigger timesheet reminders
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Reminders triggered

  /reminders/timesheet/incomplete/{organizationId}:
    get:
      tags: [Reminders]
      summary: Get users with incomplete timesheets
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Incomplete users

  /reminders/timesheet/settings/{organizationId}:
    get:
      tags: [Reminders]
      summary: Get reminder settings
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Settings
    put:
      tags: [Reminders]
      summary: Update reminder settings
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Settings updated

  /reminders/timesheet/refresh:
    post:
      tags: [Reminders]
      summary: Refresh schedulers
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Refreshed

  # ==========================================
  # EXPENSES
  # ==========================================

  /expenses/create:
    post:
      tags: [Expenses]
      summary: Create expense
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Expense created

  /expenses/categories:
    get:
      tags: [Expenses]
      summary: Get expense categories
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Categories

  /expenses/organization/{organizationId}:
    get:
      tags: [Expenses]
      summary: Get organization expenses
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Expenses

  /expenses/{expenseId}:
    get:
      tags: [Expenses]
      summary: Get expense by ID
      security:
        - bearerAuth: []
      parameters:
        - name: expenseId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Expense details
    put:
      tags: [Expenses]
      summary: Update expense
      security:
        - bearerAuth: []
      parameters:
        - name: expenseId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Expense updated
    delete:
      tags: [Expenses]
      summary: Delete expense
      security:
        - bearerAuth: []
      parameters:
        - name: expenseId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Expense deleted

  /expenses/{expenseId}/approval:
    put:
      tags: [Expenses]
      summary: Update expense approval
      security:
        - bearerAuth: []
      parameters:
        - name: expenseId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Approval updated

  /expenses/bulk-import:
    post:
      tags: [Expenses]
      summary: Bulk import expenses
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Expenses imported

  # ==========================================
  # RECURRING EXPENSES
  # ==========================================

  /api/recurring-expenses/process:
    post:
      tags: [Recurring Expenses]
      summary: Process due recurring expenses
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Expenses processed

  /api/recurring-expenses/templates:
    post:
      tags: [Recurring Expenses]
      summary: Create recurring expense template
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Template created

  /api/recurring-expenses/templates/{organizationId}:
    get:
      tags: [Recurring Expenses]
      summary: Get recurring expense templates
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Templates

  /api/recurring-expenses/templates/{templateId}:
    put:
      tags: [Recurring Expenses]
      summary: Update template
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Template updated
    delete:
      tags: [Recurring Expenses]
      summary: Deactivate template
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Template deactivated

  /api/recurring-expenses/stats/{organizationId}:
    get:
      tags: [Recurring Expenses]
      summary: Get recurring expense statistics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Statistics

  /reminders/expense/status:
    get:
      tags: [Reminders]
      summary: Get expense reminder status
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Status

  /reminders/expense/trigger:
    post:
      tags: [Reminders]
      summary: Trigger expense reminders
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Reminders triggered

  /reminders/expense/missing/{organizationId}:
    get:
      tags: [Reminders]
      summary: Get expenses missing receipts
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Missing expenses

  /reminders/expense/{expenseId}/status:
    get:
      tags: [Reminders]
      summary: Get reminder status for expense
      security:
        - bearerAuth: []
      parameters:
        - name: expenseId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Status

  /reminders/expense/settings/{organizationId}:
    get:
      tags: [Reminders]
      summary: Get expense reminder settings
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Settings
    put:
      tags: [Reminders]
      summary: Update expense reminder settings
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Settings updated

  # ==========================================
  # TRIPS
  # ==========================================

  /trips:
    post:
      tags: [Trips]
      summary: Create trip
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Trip created
    get:
      tags: [Trips]
      summary: Get all trips
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Trips list

  /trips/analytics:
    get:
      tags: [Trips]
      summary: Get enhanced invoice analytics
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Analytics

  /trips/{tripId}:
    patch:
      tags: [Trips]
      summary: Update trip details
      security:
        - bearerAuth: []
      parameters:
        - name: tripId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Trip updated

  /trips/{tripId}/status:
    patch:
      tags: [Trips]
      summary: Approve/reject trip
      security:
        - bearerAuth: []
      parameters:
        - name: tripId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [approved, rejected]
      responses:
        '200':
          description: Status updated

  /trips/employee/{userId}:
    get:
      tags: [Trips]
      summary: Get employee trips
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Employee trips

  # ==========================================
  # OCR
  # ==========================================

  /ocr/parse:
    post:
      tags: [OCR]
      summary: Parse receipt OCR
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                text:
                  type: string
      responses:
        '200':
          description: Parsed data

  # ==========================================
  # LEAVE
  # ==========================================

  /leave/balances/{userEmail}:
    get:
      tags: [Leave]
      summary: Get leave balances
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Leave balances

  /leave/request:
    post:
      tags: [Leave]
      summary: Submit leave request
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Request submitted

  /leave/requests/{userEmail}:
    get:
      tags: [Leave]
      summary: Get leave requests
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Leave requests

  /leave/forecast/{userEmail}:
    get:
      tags: [Leave]
      summary: Calculate leave forecast
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Leave forecast

  /leave/public-holidays:
    get:
      tags: [Leave]
      summary: Get public holidays
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Public holidays

  /leave/request/{requestId}/status:
    put:
      tags: [Leave]
      summary: Approve/reject leave request
      security:
        - bearerAuth: []
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Status updated

  /leave-balance/{userEmail}:
    get:
      tags: [Leave]
      summary: Get leave balances (alternate)
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Balances
    put:
      tags: [Leave]
      summary: Update leave balance
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Balance updated

  # ==========================================
  # REQUESTS
  # ==========================================

  /requests/create:
    post:
      tags: [Requests]
      summary: Create request
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Request created

  /requests/organization/{organizationId}:
    get:
      tags: [Requests]
      summary: Get requests
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Requests

  /requests/{requestId}/status:
    patch:
      tags: [Requests]
      summary: Update request status (PATCH)
      security:
        - bearerAuth: []
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Status updated
    put:
      tags: [Requests]
      summary: Update request status (PUT)
      security:
        - bearerAuth: []
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Status updated

  /requests/{requestId}/claim:
    post:
      tags: [Requests]
      summary: Claim request
      security:
        - bearerAuth: []
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Request claimed

  /requests/forecast/{userEmail}:
    get:
      tags: [Requests]
      summary: Get leave forecast
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Forecast

  /requests/calculate-hours:
    post:
      tags: [Requests]
      summary: Calculate leave hours
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Hours calculated

  # ==========================================
  # PAYROLL
  # ==========================================

  /payroll/summary:
    get:
      tags: [Payroll]
      summary: Get payroll summary
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Payroll summary

  /payroll/export/{format}:
    post:
      tags: [Payroll]
      summary: Export payroll data
      security:
        - bearerAuth: []
      parameters:
        - name: format
          in: path
          required: true
          schema:
            type: string
            enum: [csv, xlsx, pdf]
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Payroll exported

  # ==========================================
  # EARNINGS
  # ==========================================

  /earnings/summary/{userEmail}:
    get:
      tags: [Earnings]
      summary: Get earnings summary
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Earnings summary

  /earnings/projected/{userEmail}:
    get:
      tags: [Earnings]
      summary: Get projected earnings
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Projected earnings

  /earnings/history/{userEmail}:
    get:
      tags: [Earnings]
      summary: Get earnings history
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Earnings history

  /earnings/rate/{userEmail}:
    post:
      tags: [Earnings]
      summary: Set pay rate
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                rate:
                  type: number
      responses:
        '200':
          description: Rate updated

  /earnings/quarterly-ote/{userEmail}:
    get:
      tags: [Earnings]
      summary: Get quarterly OTE for super cap
      security:
        - bearerAuth: []
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Quarterly OTE

  # ==========================================
  # BANK DETAILS
  # ==========================================

  /bank-details/saveBankDetails:
    post:
      tags: [Bank Details]
      summary: Save bank details
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Bank details saved

  /bank-details/getBankDetails:
    get:
      tags: [Bank Details]
      summary: Get bank details
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Bank details

  # ==========================================
  # HOLIDAYS
  # ==========================================

  /holidays:
    get:
      tags: [Holidays]
      summary: Get all holidays
      parameters:
        - name: state
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Holidays list
    post:
      tags: [Holidays]
      summary: Add holiday
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Holiday added

  /holidays/check:
    post:
      tags: [Holidays]
      summary: Check if dates are holidays
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                dates:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Check results

  /holidays/upload-csv:
    post:
      tags: [Holidays]
      summary: Upload CSV holiday data
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
      responses:
        '200':
          description: CSV uploaded

  /holidays/{id}:
    delete:
      tags: [Holidays]
      summary: Delete holiday
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Holiday deleted

  # ==========================================
  # CALENDAR
  # ==========================================

  /calendar/sync:
    post:
      tags: [Calendar]
      summary: Sync external calendar
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Calendar synced

  /calendar/upcoming:
    get:
      tags: [Calendar]
      summary: Get upcoming events
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Upcoming events

  # ==========================================
  # TEAMS
  # ==========================================

  /teams/my-teams:
    get:
      tags: [Teams]
      summary: Get my teams
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Teams list

  /teams:
    post:
      tags: [Teams]
      summary: Create team
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Team created

  /teams/{teamId}/invite:
    post:
      tags: [Teams]
      summary: Invite member to team
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Invitation sent

  /teams/{teamId}/availability:
    get:
      tags: [Teams]
      summary: Get team availability
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Team availability

  /teams/status:
    put:
      tags: [Teams]
      summary: Update status
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Status updated

  /teams/emergency/broadcast:
    post:
      tags: [Teams]
      summary: Send emergency broadcast
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Broadcast sent

  /teams/emergency/active:
    get:
      tags: [Teams]
      summary: Get active broadcasts
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Active broadcasts

  /teams/emergency/acknowledge/{id}:
    post:
      tags: [Teams]
      summary: Acknowledge broadcast
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Acknowledged

  # ==========================================
  # EMERGENCY
  # ==========================================

  /emergency/broadcast:
    post:
      tags: [Emergency]
      summary: Emergency broadcast
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Broadcast sent

  /emergency/broadcast/{broadcastId}/acknowledge:
    put:
      tags: [Emergency]
      summary: Acknowledge broadcast
      security:
        - bearerAuth: []
      parameters:
        - name: broadcastId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Acknowledged

  # ==========================================
  # GEOFENCING
  # ==========================================

  /geofence/locations:
    post:
      tags: [Geofencing]
      summary: Create geofence
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Geofence created
    get:
      tags: [Geofencing]
      summary: Get geofences
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Geofences list

  /geofence/locations/{id}:
    put:
      tags: [Geofencing]
      summary: Update geofence
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Geofence updated
    delete:
      tags: [Geofencing]
      summary: Delete geofence
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Geofence deleted

  /api/employee-tracking/{organizationId}:
    get:
      tags: [Geofencing]
      summary: Get employee tracking data
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Tracking data

  /worker/dashboard:
    get:
      tags: [Geofencing]
      summary: Get worker dashboard data
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Dashboard data

  # ==========================================
  # NOTES
  # ==========================================

  /notes:
    post:
      tags: [Notes]
      summary: Add note for client
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Note added

  /notes/{clientEmail}:
    get:
      tags: [Notes]
      summary: Get notes for client
      security:
        - bearerAuth: []
      parameters:
        - name: clientEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Notes list

  /notes/{id}:
    put:
      tags: [Notes]
      summary: Update note
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Note updated
    delete:
      tags: [Notes]
      summary: Delete note
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Note deleted

  # ==========================================
  # NOTIFICATIONS
  # ==========================================

  /notifications/settings:
    get:
      tags: [Notifications]
      summary: Get notification settings
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Settings
    put:
      tags: [Notifications]
      summary: Update notification settings
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Settings updated

  /notifications/history:
    get:
      tags: [Notifications]
      summary: Get notification history
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/pageQuery'
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Notification history

  /notifications/{id}/read:
    put:
      tags: [Notifications]
      summary: Mark notification as read
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Marked as read

  # ==========================================
  # SNOOZE (REMINDERS)
  # ==========================================

  /snooze/rules:
    post:
      tags: [Reminders]
      summary: Create snooze rule
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Rule created
    get:
      tags: [Reminders]
      summary: Get snooze rules
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Rules list

  /snooze/check:
    post:
      tags: [Reminders]
      summary: Check if notification is snoozed
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Check result

  # ==========================================
  # COMPLIANCE & TRAINING
  # ==========================================

  /compliance/summary:
    get:
      tags: [Compliance]
      summary: Get compliance summary
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Compliance summary

  /certifications/upload:
    post:
      tags: [Training]
      summary: Upload certification
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
      responses:
        '201':
          description: Certification uploaded

  /certifications:
    get:
      tags: [Training]
      summary: Get certifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Certifications list

  /certifications/{id}/audit:
    put:
      tags: [Training]
      summary: Audit certification
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Audit recorded

  /training:
    post:
      tags: [Training]
      summary: Create training module
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Module created
    get:
      tags: [Training]
      summary: Get training modules
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Training modules

  /training/{id}/progress:
    post:
      tags: [Training]
      summary: Update training progress
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Progress updated

  /compliance:
    post:
      tags: [Compliance]
      summary: Create compliance checklist
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Checklist created
    get:
      tags: [Compliance]
      summary: Get compliance checklists
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Checklists

  /compliance/status:
    post:
      tags: [Compliance]
      summary: Update checklist status
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Status updated

  # ==========================================
  # PAYMENTS & ACCOUNTING
  # ==========================================

  /payments/create-intent:
    post:
      tags: [Payments]
      summary: Create payment intent
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Intent created

  /payments/onboarding-link:
    post:
      tags: [Payments]
      summary: Create onboarding link
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Link created

  /payments/record:
    post:
      tags: [Payments]
      summary: Record payment
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Payment recorded

  /payments/credit-note:
    post:
      tags: [Payments]
      summary: Create credit note
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Credit note created

  /payments/credit-note/apply:
    post:
      tags: [Payments]
      summary: Apply credit note
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Credit note applied

  /payments/refund:
    post:
      tags: [Payments]
      summary: Refund payment
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Payment refunded

  /accounting/connect:
    post:
      tags: [Accounting]
      summary: Initiate accounting connection
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Connection initiated

  /accounting/callback:
    post:
      tags: [Accounting]
      summary: Handle OAuth callback
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Callback handled

  /accounting/sync:
    post:
      tags: [Accounting]
      summary: Trigger manual sync
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Sync triggered

  /webhooks/stripe:
    post:
      tags: [Webhooks]
      summary: Handle Stripe webhook
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Webhook processed

  # ==========================================
  # ANALYTICS & REPORTING
  # ==========================================

  /analytics/financials:
    get:
      tags: [Analytics]
      summary: Get labor cost vs revenue
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Financial analytics

  /analytics/utilization:
    get:
      tags: [Analytics]
      summary: Get utilization rates
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Utilization metrics

  /analytics/overtime:
    get:
      tags: [Analytics]
      summary: Get overtime hotspots
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Overtime data

  /analytics/reliability:
    get:
      tags: [Analytics]
      summary: Get reliability metrics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Reliability metrics

  /analytics/cross-org/revenue:
    get:
      tags: [Analytics]
      summary: Get cross-org revenue
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Cross-org revenue

  /analytics/forecast:
    get:
      tags: [Analytics]
      summary: Get revenue forecast
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Revenue forecast

  /analytics/pricing/{organizationId}:
    get:
      tags: [Analytics]
      summary: Get pricing analytics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Pricing analytics

  /analytics/pricing/compliance/{organizationId}:
    get:
      tags: [Analytics]
      summary: Get pricing compliance report
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Compliance report

  # ==========================================
  # API USAGE ANALYTICS
  # ==========================================

  /analytics/api-usage/{organizationId}:
    get:
      tags: [API Usage]
      summary: Get API usage analytics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: API usage analytics

  /analytics/api-usage/realtime/{organizationId}:
    get:
      tags: [API Usage]
      summary: Get real-time API usage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Real-time usage

  /analytics/api-usage/unblock-ip:
    post:
      tags: [API Usage]
      summary: Unblock IP address
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                ip:
                  type: string
      responses:
        '200':
          description: IP unblocked

  /analytics/api-usage/rate-limits:
    get:
      tags: [API Usage]
      summary: Get rate limit configuration
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Rate limits

  /analytics/api-usage/stream/{organizationId}:
    get:
      tags: [API Usage]
      summary: Server-sent events for API usage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: SSE stream

  # ==========================================
  # SECURITY DASHBOARD
  # ==========================================

  /security/rate-limit/reset:
    post:
      tags: [Security]
      summary: Reset rate limiting
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Rate limit reset

  /security/rate-limit/status:
    get:
      tags: [Security]
      summary: Get rate limiting status
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Status

  /security/dashboard/metrics:
    get:
      tags: [Security]
      summary: Get security metrics
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Security metrics

  /security/dashboard/report:
    get:
      tags: [Security]
      summary: Generate security report
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Security report

  /security/dashboard/alerts/status:
    get:
      tags: [Security]
      summary: Get alerting system status
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Alert status

  /security/dashboard/alerts/test:
    post:
      tags: [Security]
      summary: Test alert system
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Alert tested

  /security/dashboard/blocked-ips:
    get:
      tags: [Security]
      summary: Get blocked IP addresses
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Blocked IPs

  /security/dashboard/unblock-ip:
    post:
      tags: [Security]
      summary: Manually unblock IP
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                ip:
                  type: string
      responses:
        '200':
          description: IP unblocked

  /security/dashboard/block-ip:
    post:
      tags: [Security]
      summary: Manually block IP
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                ip:
                  type: string
      responses:
        '200':
          description: IP blocked

  /security/dashboard/events/recent:
    get:
      tags: [Security]
      summary: Get recent security events
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Recent events

  /security/dashboard/health:
    get:
      tags: [Security]
      summary: Get security system health
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System health

  /security/api-usage/summary:
    get:
      tags: [Security]
      summary: Get API usage summary
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Usage summary

  /security/api-usage/history:
    get:
      tags: [Security]
      summary: Get API request history
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/pageQuery'
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Request history

  /security/api-usage/endpoints:
    get:
      tags: [Security]
      summary: List endpoint stats
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Endpoint statistics

  /security/api-usage/stream:
    get:
      tags: [Security]
      summary: SSE stream for real-time API usage
      security:
        - bearerAuth: []
      responses:
        '200':
          description: SSE stream

  /security/api-usage/top-ips:
    get:
      tags: [Security]
      summary: List top IPs by request count
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Top IPs

  /security/api-usage/top-users:
    get:
      tags: [Security]
      summary: List top users by request count
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Top users

  /security/api-usage/reset:
    post:
      tags: [Security]
      summary: Reset all API usage stats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Stats reset

  /security/api-usage/reset-user:
    post:
      tags: [Security]
      summary: Reset user API usage stats
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: User stats reset

  # ==========================================
  # AUDIT
  # ==========================================

  /api/audit/entity/{entityType}/{entityId}:
    get:
      tags: [Audit]
      summary: Get entity audit history
      security:
        - bearerAuth: []
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: entityId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Audit history

  /api/audit/organization/{organizationId}:
    get:
      tags: [Audit]
      summary: Get organization audit logs
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Audit logs

  /api/audit/stats/{organizationId}:
    get:
      tags: [Audit]
      summary: Get audit statistics
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Audit stats

  /api/audit/manual:
    post:
      tags: [Audit]
      summary: Create manual audit log
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Log created

  /api/audit/metadata:
    get:
      tags: [Audit]
      summary: Get audit metadata
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Metadata

  /api/audit/export:
    post:
      tags: [Audit]
      summary: Export audit logs
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Logs exported

  # ==========================================
  # SETTINGS & CONFIGURATION
  # ==========================================

  /settings/general:
    get:
      tags: [Settings]
      summary: Get general settings
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdQuery'
      responses:
        '200':
          description: Settings
    put:
      tags: [Settings]
      summary: Update general settings
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Settings updated

  /config/job-roles/{organizationId}:
    get:
      tags: [Configuration]
      summary: Get job roles
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Job roles

  /config/job-roles:
    post:
      tags: [Configuration]
      summary: Create job role
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Role created

  /config/leave-types/{organizationId}:
    get:
      tags: [Configuration]
      summary: Get leave types
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Leave types

  /config/leave-types:
    post:
      tags: [Configuration]
      summary: Create leave type
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Type created

  /config/tax-brackets:
    get:
      tags: [Configuration]
      summary: Get tax brackets
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Tax brackets

  # ==========================================
  # SUPPORT ITEMS
  # ==========================================

  /api/support-items/search:
    get:
      tags: [Support Items]
      summary: Search support items
      security:
        - bearerAuth: []
      parameters:
        - name: query
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Search results

  /api/support-items/all:
    get:
      tags: [Support Items]
      summary: Get all support items
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All support items

  # ==========================================
  # AI & VOICE
  # ==========================================

  /ai-timing/optimal-time:
    post:
      tags: [AI & Voice]
      summary: Get optimal time for task
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Optimal time

  /ai-timing/feedback:
    post:
      tags: [AI & Voice]
      summary: Record feedback on AI suggestion
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Feedback recorded

  /voice/command:
    post:
      tags: [AI & Voice]
      summary: Process voice command
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                command:
                  type: string
      responses:
        '200':
          description: Command processed

  /voice/history:
    get:
      tags: [AI & Voice]
      summary: Get voice command history
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/limitQuery'
      responses:
        '200':
          description: Command history

  # ==========================================
  # ONBOARDING
  # ==========================================

  /onboarding/status:
    get:
      tags: [Onboarding]
      summary: Get onboarding status
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Onboarding status

  /onboarding/upload:
    post:
      tags: [Onboarding]
      summary: Upload file
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
      responses:
        '200':
          description: File uploaded

  /onboarding/step/{stepName}:
    put:
      tags: [Onboarding]
      summary: Update onboarding step
      security:
        - bearerAuth: []
      parameters:
        - name: stepName
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Step updated

  /onboarding/step/personalDetails:
    put:
      tags: [Onboarding]
      summary: Update personal details
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Details updated

  /onboarding/step/bankDetails:
    put:
      tags: [Onboarding]
      summary: Update bank details
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Bank details updated

  /onboarding/step/taxDetails:
    put:
      tags: [Onboarding]
      summary: Update tax details
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Tax details updated

  /onboarding/documents:
    post:
      tags: [Onboarding]
      summary: Upload document record
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Document uploaded
    get:
      tags: [Onboarding]
      summary: List user documents
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Documents list

  /onboarding/documents/{docId}:
    delete:
      tags: [Onboarding]
      summary: Delete document
      security:
        - bearerAuth: []
      parameters:
        - name: docId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Document deleted

  /onboarding/submit:
    put:
      tags: [Onboarding]
      summary: Submit onboarding for review
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Submitted

  /onboarding/admin/pending:
    get:
      tags: [Onboarding]
      summary: List pending onboardings
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Pending list

  /onboarding/admin/documents/{userId}:
    get:
      tags: [Onboarding]
      summary: Get documents for user
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User documents

  /onboarding/admin/verify-document/{docId}:
    put:
      tags: [Onboarding]
      summary: Approve/reject document
      security:
        - bearerAuth: []
      parameters:
        - name: docId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Document verified

  /onboarding/admin/finalize/{userId}:
    put:
      tags: [Onboarding]
      summary: Complete onboarding
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Onboarding completed

  /onboarding/admin/check-probation:
    post:
      tags: [Onboarding]
      summary: Trigger probation check
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Check triggered

  # ==========================================
  # SYSTEM & MONITORING
  # ==========================================

  /metrics:
    get:
      tags: [System]
      summary: Prometheus metrics endpoint
      responses:
        '200':
          description: Metrics

  /api/metrics/system:
    get:
      tags: [System]
      summary: System health metrics
      responses:
        '200':
          description: System metrics

  /api/metrics/business:
    get:
      tags: [System]
      summary: Business metrics
      responses:
        '200':
          description: Business metrics

  /upload/logo:
    post:
      tags: [System]
      summary: Upload logo
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                logo:
                  type: string
                  format: binary
      responses:
        '200':
          description: Logo uploaded

  # ==========================================
  # SCHEDULER
  # ==========================================

  /scheduler/high-frequency:
    post:
      tags: [Scheduler]
      summary: Trigger high-frequency tasks
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Tasks triggered

  /scheduler/medium-frequency:
    post:
      tags: [Scheduler]
      summary: Trigger medium-frequency tasks
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Tasks triggered

  /scheduler/daily:
    post:
      tags: [Scheduler]
      summary: Trigger daily tasks
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Tasks triggered

  /scheduler/status:
    get:
      tags: [Scheduler]
      summary: Get scheduler status
      responses:
        '200':
          description: Scheduler status

  # ==========================================
  # ADMIN INVOICE PROFILE
  # ==========================================

  /api/admin-invoice-profile:
    post:
      tags: [Invoicing]
      summary: Create admin invoice profile
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Profile created

  /api/admin-invoice-profile/{organizationId}:
    get:
      tags: [Invoicing]
      summary: Get active profile by organization
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/organizationIdPath'
      responses:
        '200':
          description: Active profile

  /api/admin-invoice-profile/{profileId}:
    put:
      tags: [Invoicing]
      summary: Update admin invoice profile
      security:
        - bearerAuth: []
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Profile updated
    delete:
      tags: [Invoicing]
      summary: Soft delete admin invoice profile
      security:
        - bearerAuth: []
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Profile deleted
